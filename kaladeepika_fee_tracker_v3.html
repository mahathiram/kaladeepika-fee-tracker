<script>
  document.addEventListener('DOMContentLoaded', function () {
    const SPREADSHEET_ID = '1T0V-PdffEzfdMgpjey9A5fZxr-EJ-xvHSH9gPNptuKM';
    const SHEET_NAME = 'Jun25';  // Adjust this to your actual sheet tab name

    const url = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:json&tq&sheet=${SHEET_NAME}`;

    fetch(url)
      .then(res => res.text())
      .then(text => {
        const json = JSON.parse(text.substring(47, text.length - 2));
        const table = json.table;

        const headers = table.cols.map(col => col.label || '');
        const rows = table.rows.map(row => row.c.map(cell => cell?.v ?? ''));

        document.getElementById("table-headers").innerHTML =
          headers.map(h => `<th>${h}</th>`).join("");

        document.getElementById("data-body").innerHTML =
          rows.map(row => `<tr>${row.map(cell => `<td>${cell}</td>`).join('')}</tr>`).join('');
      })
      .catch(err => {
        console.error("Error fetching sheet data:", err);
        document.getElementById("data-body").innerHTML =
          "<tr><td colspan='4'>Error loading data.</td></tr>";
      });
  });
</script>
